---
title: "附錄 C：練習題解答"
---

```{r}
#| include: false
source(here::here("R/_common.R"))
```

::: {.callout-note}
## 關於解答

本附錄提供各章節練習題的詳細解答。建議先自行嘗試解題，再對照答案。
:::

## Part I：基礎概念

### Chapter 1：函數與圖形

#### 觀念題

**1. 為什麼劑量反應曲線通常呈 S 型？**

解答：劑量反應曲線（如 Emax model）呈現類似 S 型的原因是：

- 低劑量時：反應隨劑量快速上升
- 中等劑量時：反應接近線性增加
- 高劑量時：反應趨近飽和（最大效應 Emax）

這反映了生理系統的飽和特性：受體數量有限，當大部分受體被佔據後，增加劑量也無法顯著增加效應。

**2. 函數的定義域在醫學研究中有何重要性？**

解答：定義域（可能的 x 值範圍）在醫學研究中非常重要：

- 劑量必須 ≥ 0（不可能有負劑量）
- 年齡必須 > 0
- 存活時間必須 ≥ 0
- 機率必須在 [0, 1] 之間

選擇錯誤的定義域可能導致無意義或危險的預測。

#### 計算題

**1. 若藥物濃度隨時間呈指數衰減：$C(t) = 100e^{-0.5t}$，求 $t=2$ 小時時的濃度。**

```{r}
C <- function(t) 100 * exp(-0.5 * t)
C(2)
```

解答：約 36.8 mg/L

#### R 操作題

**1. 修改劑量反應曲線的 EC50 值，觀察曲線變化。**

```{r}
#| eval: false

library(ggplot2)

dose <- seq(0, 100, by = 1)
emax <- 100

# 嘗試不同的 EC50 值
ec50_values <- c(10, 20, 40, 80)

plot_list <- lapply(ec50_values, function(ec50) {
  response <- (emax * dose) / (ec50 + dose)

  ggplot(data.frame(dose, response), aes(dose, response)) +
    geom_line(color = "#2E86AB", linewidth = 1.2) +
    labs(title = paste("EC50 =", ec50), y = "Response") +
    theme_minimal()
})
```

觀察：EC50 越大，曲線越右移；EC50 越小，曲線越左移。

---

### Chapter 2：極限

#### 觀念題

**1. 極限與函數值有何不同？**

解答：

- **極限**：$x$ 趨近某值時，$f(x)$ 趨近的值
- **函數值**：$f(x)$ 在某點的實際值

例如：$f(x) = \frac{x^2-4}{x-2}$ 在 $x=2$ 處未定義（函數值不存在），但 $\lim_{x \to 2} f(x) = 4$（極限存在）。

**2. 為什麼大數法則需要用到極限概念？**

解答：大數法則說明當樣本數 $n \to \infty$ 時，樣本平均數 $\bar{X}_n$ 會趨近（收斂）到真實平均數 $\mu$：

$$\lim_{n \to \infty} \bar{X}_n = \mu$$

這是「趨近」的概念，不是「等於」，因此需要極限來精確描述。

---

### Chapter 3：連續性

#### 觀念題

**1. 為什麼機率密度函數（PDF）必須是連續函數？**

解答：對於連續型隨機變數，PDF 必須連續以確保：

- 機率能夠用面積表示（積分存在）
- 累積分布函數（CDF）能夠良好定義
- 數學處理更方便（可微分）

但注意：存活分析中的 Kaplan-Meier 曲線是階梯函數（不連續），因為觀察到的死亡事件是離散的。

---

## Part II：微分

### Chapter 4：導數的概念

#### 觀念題

**1. Hazard rate 與導數有何關係？**

解答：Hazard function 本質上是瞬時死亡率，定義為：

$$h(t) = \lim_{\Delta t \to 0} \frac{P(t < T \leq t + \Delta t | T > t)}{\Delta t}$$

這正是導數的定義！也可表示為：

$$h(t) = \frac{f(t)}{S(t)} = -\frac{d}{dt}\ln S(t)$$

#### 計算題

**1. 求 $f(x) = x^3 - 3x$ 在 $x=2$ 處的導數。**

解答：
$$f'(x) = 3x^2 - 3$$
$$f'(2) = 3(2)^2 - 3 = 12 - 3 = 9$$

```{r}
f <- function(x) x^3 - 3*x
f_prime <- function(x) 3*x^2 - 3
f_prime(2)
```

---

### Chapter 5：微分規則

#### 計算題

**1. 求 $f(x) = e^{x^2}$ 的導數（使用連鎖律）。**

解答：

令 $u = x^2$，則 $f(x) = e^u$

- 外層導數：$\frac{d}{du}e^u = e^u$
- 內層導數：$\frac{du}{dx} = 2x$

根據連鎖律：
$$f'(x) = e^{u} \cdot 2x = 2xe^{x^2}$$

**2. 求 Logistic 函數 $p(x) = \frac{1}{1+e^{-x}}$ 的導數。**

解答：

使用除法規則或改寫為 $(1+e^{-x})^{-1}$ 使用連鎖律：

$$p'(x) = -1 \cdot (1+e^{-x})^{-2} \cdot (-e^{-x}) = \frac{e^{-x}}{(1+e^{-x})^2}$$

化簡：
$$p'(x) = \frac{1}{1+e^{-x}} \cdot \frac{e^{-x}}{1+e^{-x}} = p(x) \cdot (1-p(x))$$

這個結果非常重要！Logistic 函數的導數就是 $p(1-p)$。

---

### Chapter 6：指數與對數函數

#### 觀念題

**1. 為什麼統計學中常使用 log-likelihood 而不是 likelihood？**

解答：三個主要原因：

1. **數值穩定性**：Likelihood 通常是很多小機率的乘積，容易數值下溢（underflow）。取 log 後變成加法，數值更穩定。

2. **微分簡化**：
   - $L(\theta) = \prod f(x_i|\theta)$ 微分複雜（乘法規則）
   - $\ell(\theta) = \sum \ln f(x_i|\theta)$ 微分簡單（和的導數）

3. **最佳化等價**：因為 $\ln$ 是遞增函數，最大化 $L(\theta)$ 等價於最大化 $\ell(\theta)$。

#### 計算題

**1. 若 $y = \ln(x^2 + 1)$，求 $\frac{dy}{dx}$。**

解答：使用連鎖律：

$$\frac{dy}{dx} = \frac{1}{x^2+1} \cdot 2x = \frac{2x}{x^2+1}$$

---

### Chapter 7：最佳化

#### 計算題

**1. 求 $f(x) = -x^2 + 4x - 1$ 的最大值。**

解答：

1. 求導數：$f'(x) = -2x + 4$
2. 令導數為零：$-2x + 4 = 0 \Rightarrow x = 2$
3. 二階導數：$f''(x) = -2 < 0$（凹向下，確認是最大值）
4. 最大值：$f(2) = -4 + 8 - 1 = 3$

```{r}
f <- function(x) -x^2 + 4*x - 1
optimize(f, interval = c(0, 10), maximum = TRUE)
```

**2. MLE 估計：給定樣本 3, 5, 7 來自常態分布 $N(\mu, 1)$，求 $\mu$ 的 MLE。**

解答：

Log-likelihood：
$$\ell(\mu) = -\frac{1}{2}\sum_{i=1}^3 (x_i - \mu)^2 + \text{常數}$$

求導：
$$\frac{d\ell}{d\mu} = \sum_{i=1}^3 (x_i - \mu) = 0$$

解得：
$$\hat{\mu} = \frac{1}{3}\sum x_i = \frac{3+5+7}{3} = 5$$

```{r}
data <- c(3, 5, 7)
mean(data)  # MLE = sample mean
```

---

## Part III：積分

### Chapter 8：積分的概念

#### 觀念題

**1. 為什麼標準常態分布在 $(-\infty, \infty)$ 的積分等於 1？**

解答：這是機率的基本性質：所有可能結果的機率總和必須為 1。

$$\int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx = 1$$

這個積分沒有初等函數形式的解析解，但可以用極座標變換證明確實等於 1。

#### 計算題

**1. 求標準常態分布在 $[0, 1]$ 的機率。**

解答：

$$P(0 \leq X \leq 1) = \int_0^1 \frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx$$

這個積分需要用數值方法或查表：

```{r}
pnorm(1) - pnorm(0)
```

答案：約 0.341

---

### Chapter 10：瑕積分

#### 計算題

**1. 驗證指數分布 $f(x) = \lambda e^{-\lambda x}$ ($x \geq 0$) 的總機率為 1。**

解答：

$$\int_0^{\infty} \lambda e^{-\lambda x}dx = \lambda \left[-\frac{1}{\lambda}e^{-\lambda x}\right]_0^{\infty}$$
$$= \lambda \left(0 - (-\frac{1}{\lambda})\right) = 1 \quad \checkmark$$

---

## Part IV：多變量微積分

### Chapter 11：偏微分

#### 計算題

**1. 求 $f(x, y) = x^2 + 3xy + y^2$ 的偏微分。**

解答：

對 $x$ 的偏微分（視 $y$ 為常數）：
$$\frac{\partial f}{\partial x} = 2x + 3y$$

對 $y$ 的偏微分（視 $x$ 為常數）：
$$\frac{\partial f}{\partial y} = 3x + 2y$$

---

## Part V：統計應用

### Chapter 14：最大概似估計

#### 綜合題

**1. Poisson 分布的 MLE**

給定觀測值 2, 3, 1, 4, 2，求 Poisson 參數 $\lambda$ 的 MLE。

解答：

Likelihood：
$$L(\lambda) = \prod_{i=1}^5 \frac{\lambda^{x_i}e^{-\lambda}}{x_i!}$$

Log-likelihood：
$$\ell(\lambda) = \sum x_i \ln \lambda - 5\lambda + \text{常數}$$

求導：
$$\frac{d\ell}{d\lambda} = \frac{\sum x_i}{\lambda} - 5 = 0$$

解得：
$$\hat{\lambda} = \frac{\sum x_i}{5} = \frac{2+3+1+4+2}{5} = 2.4$$

```{r}
data <- c(2, 3, 1, 4, 2)
lambda_mle <- mean(data)
lambda_mle
```

---

### Chapter 16：存活分析

#### 計算題

**1. 指數存活模型的 hazard function**

若 $T \sim \text{Exp}(\lambda)$，即 $f(t) = \lambda e^{-\lambda t}$，求 hazard function。

解答：

Survival function：
$$S(t) = \int_t^{\infty} \lambda e^{-\lambda u}du = e^{-\lambda t}$$

Hazard function：
$$h(t) = \frac{f(t)}{S(t)} = \frac{\lambda e^{-\lambda t}}{e^{-\lambda t}} = \lambda$$

結論：指數分布的 hazard 是常數（無記憶性）！

---

::: {.callout-tip}
## 學習建議

1. 不要只看答案，要理解解題過程
2. 用 R 驗證計算結果
3. 遇到不懂的地方，回到對應章節複習概念
4. 嘗試用不同方法解同一題
:::

::: {.callout-note}
## 持續更新

本附錄會隨著書籍內容更新而持續補充更多練習題解答。
:::
