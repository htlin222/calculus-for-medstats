# Part IV: 多變量微積分 {.unnumbered}

在前面的章節中，我們專注於單變量函數：一個 input 對應一個 output。但在真實的醫學統計問題中，我們經常需要處理**多個變數同時變化**的情況。

## 為什麼醫師需要懂多變量微積分？

### 臨床實例

想像你在研究某個新藥的療效。患者的治療結果可能同時受到：

- **劑量** (x)：給藥多少
- **年齡** (y)：患者年齡
- **共病數** (z)：同時有幾種疾病

治療結果 $R$ 不是單一變數的函數，而是：

$$R = f(\text{劑量}, \text{年齡}, \text{共病數})$$

這是一個**多變量函數** (multivariate function)。

### 統計方法中的多變量微積分

以下統計方法都需要多變量微積分：

| 統計方法 | 多變量函數 | 需要的微積分 |
|---------|-----------|------------|
| **多元迴歸** | $Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots$ | 偏微分求係數 |
| **最大概似估計** | $L(\theta_1, \theta_2, \ldots \mid \text{data})$ | 偏微分找最大值 |
| **聯合機率分布** | $f(x, y)$ | 多重積分算機率 |
| **邊際分布** | $f_X(x) = \int f(x,y) dy$ | 積分掉一個變數 |
| **貝氏統計** | $p(\theta_1, \theta_2 \mid \text{data})$ | 多重積分計算後驗 |

## Part IV 學習地圖

```
Chapter 11: 偏微分 (Partial Derivatives)
├─ 多變量函數的視覺化（3D 曲面）
├─ 偏微分的概念與計算
├─ 梯度與方向導數
└─ 應用：多元迴歸、多參數 MLE

Chapter 12: 多重積分 (Multiple Integrals)
├─ 雙重積分的概念（體積）
├─ 積分順序與範圍
├─ 聯合機率分布
└─ 應用：邊際分布、期望值計算
```

## 學習目標

完成 Part IV 後，你將能夠：

✅ **視覺化理解**多變量函數（用 3D 圖）
✅ **計算偏微分**，理解「固定其他變數」的意義
✅ **理解多元迴歸係數**的數學推導
✅ **計算雙重積分**，推導邊際分布
✅ **連結到統計**：聯合分布、MLE、貝氏統計

## 給醫師的學習建議

### 這部分比前面難嗎？

**是，也不是。**

- **難點**：多了一個維度，需要空間想像力
- **好消息**：概念跟單變量一樣，只是「多做幾次」

### 學習策略

1. **善用 3D 視覺化**：R 的 `plotly` 可以互動旋轉，多看幾次就懂了
2. **從具體例子入手**：每個公式都對應一個醫學統計情境
3. **記住「固定其他變數」**：偏微分的核心就是這句話
4. **別怕積分符號**：$\int \int f(x,y) \, dx \, dy$ 只是「先對 $x$ 積分，再對 $y$ 積分」

## 醫學統計的核心：多變量思維

在臨床研究中，我們幾乎從不處理單一變數：

- **調整共變數 (adjusting for covariates)**：就是在多變量函數中控制某些變數
- **交互作用 (interaction)**：$f(x, y)$ 中 $x$ 和 $y$ 互相影響
- **聯合分布 (joint distribution)**：兩個以上變數的機率同時考慮

掌握多變量微積分，你就能真正理解這些統計方法的數學本質。

---

**準備好了嗎？讓我們從 3D 世界開始探索！** 🚀
